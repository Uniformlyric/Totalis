---
import AppLayout from '../layouts/AppLayout.astro';
import { MainLayout } from '../components/layout/MainLayout';
---

<AppLayout title="Settings">
  <MainLayout client:load>
    <div class="space-y-6">
      <div>
        <h1 class="text-2xl font-bold text-text">Settings</h1>
        <p class="text-text-secondary mt-1">Manage your preferences</p>
      </div>
      
      <div class="grid gap-6">
        <!-- Theme Settings -->
        <div class="bg-surface rounded-xl border border-border p-6">
          <h2 class="text-lg font-semibold text-text mb-4">Appearance</h2>
          <div class="space-y-4">
            <div class="flex items-center justify-between">
              <div>
                <p class="font-medium text-text">Theme</p>
                <p class="text-sm text-text-secondary">Choose your preferred color scheme</p>
              </div>
              <div class="flex gap-2">
                <button 
                  id="theme-celestial"
                  class="px-4 py-2 rounded-lg border-2 border-primary bg-primary/10 text-primary font-medium transition-colors"
                >
                  ðŸŒ™ Celestial
                </button>
                <button 
                  id="theme-sunset"
                  class="px-4 py-2 rounded-lg border border-border text-text-secondary hover:border-text-muted transition-colors"
                >
                  ðŸŒ… Sunset
                </button>
                <button 
                  id="theme-system"
                  class="px-4 py-2 rounded-lg border border-border text-text-secondary hover:border-text-muted transition-colors"
                >
                  ðŸ’» System
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Notification Settings -->
        <div class="bg-surface rounded-xl border border-border p-6">
          <h2 class="text-lg font-semibold text-text mb-4">Notifications</h2>
          <div class="space-y-4">
            <div class="flex items-center justify-between py-2">
              <div>
                <p class="font-medium text-text">Morning Summary</p>
                <p class="text-sm text-text-secondary">Daily overview at 8:00 AM</p>
              </div>
              <button class="w-12 h-6 rounded-full bg-primary relative transition-colors">
                <span class="absolute right-1 top-1 w-4 h-4 bg-white rounded-full"></span>
              </button>
            </div>
            <div class="flex items-center justify-between py-2 border-t border-border">
              <div>
                <p class="font-medium text-text">Evening Recap</p>
                <p class="text-sm text-text-secondary">Daily summary at 9:00 PM</p>
              </div>
              <button class="w-12 h-6 rounded-full bg-primary relative transition-colors">
                <span class="absolute right-1 top-1 w-4 h-4 bg-white rounded-full"></span>
              </button>
            </div>
            <div class="flex items-center justify-between py-2 border-t border-border">
              <div>
                <p class="font-medium text-text">Push Notifications</p>
                <p class="text-sm text-text-secondary">Receive browser notifications</p>
              </div>
              <button class="w-12 h-6 rounded-full bg-surface-hover relative transition-colors">
                <span class="absolute left-1 top-1 w-4 h-4 bg-text-muted rounded-full"></span>
              </button>
            </div>
          </div>
        </div>
        
        <!-- Account Settings -->
        <div class="bg-surface rounded-xl border border-border p-6">
          <h2 class="text-lg font-semibold text-text mb-4">Account</h2>
          <p class="text-text-secondary">Account management coming soon</p>
        </div>
      </div>
    </div>
  </MainLayout>
</AppLayout>

<script>
  // Theme switching
  const celestialBtn = document.getElementById('theme-celestial');
  const sunsetBtn = document.getElementById('theme-sunset');
  const systemBtn = document.getElementById('theme-system');
  
  function setTheme(theme: string) {
    localStorage.setItem('totalis-theme', theme);
    
    if (theme === 'sunset') {
      document.documentElement.setAttribute('data-theme', 'sunset');
    } else if (theme === 'system') {
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (prefersDark) {
        document.documentElement.removeAttribute('data-theme');
      } else {
        document.documentElement.setAttribute('data-theme', 'sunset');
      }
    } else {
      document.documentElement.removeAttribute('data-theme');
    }
    
    updateButtons(theme);
  }
  
  function updateButtons(theme: string) {
    const buttons = [celestialBtn, sunsetBtn, systemBtn];
    buttons.forEach(btn => {
      if (btn) {
        btn.className = 'px-4 py-2 rounded-lg border transition-colors ';
        if ((theme === 'celestial' && btn === celestialBtn) ||
            (theme === 'sunset' && btn === sunsetBtn) ||
            (theme === 'system' && btn === systemBtn)) {
          btn.className += 'border-2 border-primary bg-primary/10 text-primary font-medium';
        } else {
          btn.className += 'border-border text-text-secondary hover:border-text-muted';
        }
      }
    });
  }
  
  celestialBtn?.addEventListener('click', () => setTheme('celestial'));
  sunsetBtn?.addEventListener('click', () => setTheme('sunset'));
  systemBtn?.addEventListener('click', () => setTheme('system'));
  
  // Initialize buttons based on current theme
  const currentTheme = localStorage.getItem('totalis-theme') || 'celestial';
  updateButtons(currentTheme);
</script>
